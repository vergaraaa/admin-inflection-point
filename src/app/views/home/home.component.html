<div class="container mt-5">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1">
          <i class="fas fa-search"></i>
        </span>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="query"
          placeholder="Buscar"
          aria-label="Search"
          aria-describedby="basic-addon1"
        />
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-10 mx-auto">
      <div class="table-responsive-md">
        <table class="table text-center align-middle">
          <thead class="text-white" style="background-color: #282c38">
            <tr>
              <th class="col-2 clickable" (click)="sort('name', ascDescBool)">
                API
              </th>
              <th
                class="col-5 clickable"
                (click)="sort('description', ascDescBool)"
              >
                Descripción
              </th>
              <th class="col-3 clickable" (click)="sort('url', ascDescBool)">
                URL
              </th>
              <th class="col-2 clickable" (click)="sort('status', ascDescBool)">
                Estatus
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let api of search()">
              <td
                scope="row"
                class="clickable align-left"
                [routerLink]="['/api/', api.id]"
              >
                {{ api.name }}
              </td>
              <td>
                <button
                  class="btn btn-toggle align-items-center rounded collapsed"
                  data-bs-toggle="collapse"
                  [attr.data-bs-target]="'#descripcion' + api.id"
                  aria-expanded="false"
                >
                  Descripción
                </button>
                <div class="collapse" [attr.id]="'descripcion' + api.id">
                  <p>
                    {{ api.description }}
                  </p>
                </div>
              </td>
              <td>
                {{ api.url }}
              </td>
              <td>
                <div
                  [ngClass]="
                    statusData[api.id!]
                      ? statusData[api.id!].status
                        ? 'estatus'
                        : 'estatus-error'
                      : 'estatus-error'
                  "
                  class="mx-auto"
                  [tooltip]="
                    statusData[api.id!]
                      ? statusData[api.id!].status
                        ? 'Última vez actualizado: ' +
                          statusData[api.id!].routes[0].lastSeen
                        : 'Última vez actualizado: No Disponible'
                      : 'Última vez actualizado: No Disponible'
                  "
                ></div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
